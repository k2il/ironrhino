<!doctype html>
<html>
	<head>
		<title>WebSockets test</title>
		<meta charset="utf-8" />
		<script src="http://code.jquery.com/jquery.min.js"></script>
		<script>
			$(document).ready(function () {
				$('#uri').val('/chat?name='+($.browser.webkit?'webkit':$.browser.mozilla?'mozilla':$.browser.opera?'opera':$.browser.msie?'msie':'unknown'));
				var socket;
				$("#open").click(function(event) {
					event.preventDefault();
					var host = $("#host").val();
					var port = $("#port").val();
					var uri = $("#uri").val();
					socket = new WebSocket("ws://" + host + ":" + port + uri);
					socket.onmessage = function(event) {
						if(uri=='/datetime')
							$('#msg').text( event.data);
						else
							$('#msg').append( event.data+'<br/>');
					};
					socket.onerror = function(event) { $('#status').text("Connection error"); };
					socket.onclose = function(event) { $('#status').text("Connection close"); };
					socket.onopen = function(event) { $('#status').text("Connection open"); };
				});
				$("#close").click(function(event) {
					event.preventDefault();
					socket.close();
				});
				$("#send").click(function(event) {
					event.preventDefault();
					socket.send($("#message").val());
					$("#message").val('');
				});
			});
		</script>
	</head>
	<body>
		<form>
			<label for="host">host:</label>
			<input type="text" id="host" value="localhost" /><br />
			<label for="port">port:</label>
			<input type="number" id="port" value="8080" /><br />
			<label for="uri">uri:</label>
			<input type="text" id="uri"/><br />
			<input type="submit" id="open" value="open" />
			<input type="submit" id="close" value="close" /><br />
			<div id="status"></div>
			<textarea placeholder="Write your message here" id="message"></textarea><br />
			<input type="submit" id="send" value="send" />
			<div id="msg"></div>
		</form>
	</body>
</html>
