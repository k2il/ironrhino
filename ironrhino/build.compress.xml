<?xml version="1.0" encoding="utf-8"?>
<project name="ironrhino-compress" default="compress" basedir=".">

	<property name="version" value="1.0" />
	<property name="webapp.dir" location="${basedir}/webapp" />
	<property name="lib.dir" location="${basedir}/lib" />
	<property name="classes.dir" location="${webapp.dir}/WEB-INF/classes" />
	<property name="target.dir" location="${basedir}/target" />

	<target name="compress">
		<antcall target="compressScripts" />
		<antcall target="compressStyles" />
	</target>

	<target name="compressScripts">
		<concat destfile="${webapp.dir}/assets/scripts/ironrhino.js" encoding="utf-8" fixlastline="yes">
			<filelist>
				<file name="${webapp.dir}/assets/scripts/source/jquery-1.9.1.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.browser-1.0.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.cookie-1.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.ui-1.10.1.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.ui.datepicker-zh-CN-1.10.1.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.history-2.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.rc4-1.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.form-2.95.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.loadmask-0.4.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.tmpl-1.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.alerts-1.1.my.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.textext-1.3.0.my.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.treeview-1.4.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.treeview.async-0.1.my.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.treeTable-2.3.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.clickmenu-0.1.6.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.columnmanager-0.2.5.my.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.throttle-debounce-1.1.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.htmlarea-0.7.5.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.chosen-0.9.11.js" />
				<file name="${webapp.dir}/assets/scripts/source/swfobject-2.2.js" />
				<file name="${webapp.dir}/assets/scripts/source/bootstrap-2.3.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.messagebundle.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.core.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.checkavailable.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.ajaxupload.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.snapshot.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.decodeqrcode.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.encodeqrcode.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.upload.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.ajaxpanel.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.checkbox.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.sortabletable.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.datagridtable.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.portal.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.combobox.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.tags.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.resizabletable.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.richtable.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.treearea.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.treeselect.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.listpick.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.imagepick.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.latlng.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.editme.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.filtercolumn.js" />
			</filelist>
		</concat>
		<concat destfile="${webapp.dir}/assets/scripts/ironrhino-lite.js" encoding="utf-8" fixlastline="yes">
			<filelist>
				<file name="${webapp.dir}/assets/scripts/source/jquery.browser-1.0.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.cookie-1.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.rc4-1.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.form-2.95.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.history-2.0.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.alerts-1.1.my.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.textext-1.3.0.my.js" />
				<file name="${webapp.dir}/assets/scripts/source/jquery.throttle-debounce-1.1.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.messagebundle.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.core.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.checkavailable.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.tags.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.ajaxupload.js" />
				<file name="${webapp.dir}/assets/scripts/source/ironrhino.ajaxpanel.js" />
			</filelist>
		</concat>
		<replace file="${webapp.dir}/assets/scripts/ironrhino.js" token="@license" value="license" encoding="utf-8" />
		<java jar="${lib.dir}/closure-compiler.jar" fork="true">
			<arg line=" --js=./webapp/assets/scripts/ironrhino.js --js_output_file=./webapp/assets/scripts/ironrhino-min.js" />
		</java>
		<replace file="${webapp.dir}/assets/scripts/ironrhino-lite.js" token="@license" value="license" encoding="utf-8" />
		<java jar="${lib.dir}/closure-compiler.jar" fork="true">
			<arg line=" --js=./webapp/assets/scripts/ironrhino-lite.js --js_output_file=./webapp/assets/scripts/ironrhino-lite-min.js" />
		</java>
		<delete file="${basedir}/webapp/assets/scripts/ironrhino-lite.js" />
	</target>

	<target name="compressStyles">
		<concat destfile="${webapp.dir}/assets/styles/ironrhino.css" encoding="utf-8" fixlastline="yes">
			<filelist>
				<file name="${webapp.dir}/assets/styles/source/jquery.ui.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.loadmask.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.treeview.my.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.treeTable.my.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.alerts.my.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.textext.my.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.clickmenu.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.chosen.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.htmlarea.css" />
				<file name="${webapp.dir}/assets/styles/source/bootstrap.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.core.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.form.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.editme.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.portal.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.sortabletable.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.resizabletable.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.richtable.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.filtercolumn.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.treearea.css" />
				<file name="${webapp.dir}/assets/styles/source/bootstrap-responsive.css" />
			</filelist>
		</concat>
		<concat destfile="${webapp.dir}/assets/styles/ironrhino-lite.css" encoding="utf-8" fixlastline="yes">
			<filelist>
				<file name="${webapp.dir}/assets/styles/source/jquery.alerts.my.css" />
				<file name="${webapp.dir}/assets/styles/source/jquery.textext.my.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.core.css" />
				<file name="${webapp.dir}/assets/styles/source/ironrhino.form.css" />
			</filelist>
		</concat>
		<replaceregexp file="${webapp.dir}/assets/styles/ironrhino.css" match="^\/\*!" replace="/*" byline="true" encoding="utf-8" />
		<java jar="${lib.dir}/yuicompressor.jar" fork="true">
			<arg line=" --charset utf-8 --type css -o ./webapp/assets/styles/ironrhino-min.css ./webapp/assets/styles/ironrhino.css" />
		</java>
		<replaceregexp file="${webapp.dir}/assets/styles/ironrhino-lite.css" match="^\/\*!" replace="/*" byline="true" encoding="utf-8" />
		<java jar="${lib.dir}/yuicompressor.jar" fork="true">
			<arg line=" --charset utf-8 --type css -o ./webapp/assets/styles/ironrhino-lite-min.css ./webapp/assets/styles/ironrhino-lite.css" />
		</java>
		<delete file="${basedir}/webapp/assets/styles/ironrhino-lite.css" />
	</target>

</project>
